import{c as Q,u as _,r as u,R as X,j as e,a as J,m as R,b as P,M as L,G as C,N as S,d as Z,e as B}from"./index-D6kfz2qZ.js";const ee=Q(t=>({logs:[],isLoading:!1,error:null,fetchLogs:async o=>{t({isLoading:!0,error:null});try{const r=await window.electron.getGroupAuditLogs(o);r.success?t({logs:r.logs||[],isLoading:!1}):t({error:r.error,isLoading:!1})}catch(r){t({error:r.message||"Failed to fetch logs",isLoading:!1})}}}));function U({type:t,enabled:o=!0}){const{selectedGroup:r,fetchGroupRequests:a,fetchGroupBans:l,fetchGroupMembers:p,fetchGroupInstances:c,isRequestsLoading:i,isBansLoading:m,isMembersLoading:g,isInstancesLoading:n,getLastFetchedAt:y}=_(),d=X[t],[b,j]=u.useState(()=>{const v=y(t);if(v===0)return Math.floor(d/1e3);const N=d-(Date.now()-v);return Math.max(1,Math.ceil(N/1e3))}),s=u.useRef(null),f=u.useRef(null),I=u.useRef(!1),E=t==="requests"?i:t==="bans"?m:t==="members"?g:n,w=u.useCallback(async()=>{if(r)switch(t){case"requests":await a(r.id);break;case"bans":await l(r.id);break;case"members":await p(r.id,0);break;case"instances":await c(r.id);break}},[r,t,a,l,p,c]),A=u.useCallback(()=>{w(),j(Math.floor(d/1e3))},[w,d]);return u.useEffect(()=>{if(!r||!o)return;const v=y(t),N=Date.now()-v;return(v===0||N>=d)&&(I.current||(I.current=!0,w())),()=>{I.current=!1}},[r?.id,o,t,d,w,y,r]),u.useEffect(()=>{if(s.current&&(clearInterval(s.current),s.current=null),f.current&&(clearInterval(f.current),f.current=null),!(!r||!o))return s.current=setInterval(()=>{w(),j(Math.floor(d/1e3))},d),f.current=setInterval(()=>{j(v=>v<=1?Math.floor(d/1e3):v-1)},1e3),()=>{s.current&&(clearInterval(s.current),s.current=null),f.current&&(clearInterval(f.current),f.current=null)}},[r,o,d,w]),{secondsUntilRefresh:b,isRefreshing:E,refreshNow:A,lastFetchedAt:y(t)}}function Y(t){if(t<60)return`${t}s`;const o=Math.floor(t/60),r=t%60;return`${o}:${r.toString().padStart(2,"0")}`}const M=({secondsUntilRefresh:t,isRefreshing:o,onRefreshClick:r,label:a="Refresh"})=>{const l=t>0,p=o||l;return e.jsxs("button",{onClick:r,disabled:p,style:{display:"inline-flex",alignItems:"center",gap:"3px",background:"transparent",border:"none",padding:"2px 4px",fontSize:"0.65rem",color:"var(--color-text-dim)",cursor:p?"default":"pointer",transition:"color 0.15s ease",opacity:l?.5:.7},onMouseEnter:c=>{p||(c.currentTarget.style.color="var(--color-primary)",c.currentTarget.style.opacity="1")},onMouseLeave:c=>{c.currentTarget.style.color="var(--color-text-dim)",c.currentTarget.style.opacity=l?"0.5":"0.7"},title:t>0?`${a} in ${Y(t)}`:"Click to refresh",children:[e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{animation:o?"spin 0.8s linear infinite":"none"},children:e.jsx("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"})}),(t>0||o)&&e.jsx("span",{style:{fontFamily:"monospace",fontSize:"0.6rem",letterSpacing:"-0.02em"},children:o?"â€¢â€¢â€¢":Y(t)}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})},te=()=>{const{connected:t,connecting:o}=J();return e.jsx(R.div,{title:t?"Real-time updates active":o?"Connecting...":"Offline",style:{width:8,height:8,borderRadius:"50%",backgroundColor:t?"#22c55e":o?"#f59e0b":"#6b7280",boxShadow:t?"0 0 6px rgba(34, 197, 94, 0.6)":"none"},animate:t?{scale:[1,1.2,1]}:{},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})},se=({isOpen:t,onClose:o})=>{const{members:r,selectedGroup:a,fetchGroupMembers:l,isMembersLoading:p}=_(),{openProfile:c}=P(),[i,m]=u.useState("");u.useEffect(()=>{t&&a&&l(a.id)},[t,a,l]);const g=r.filter(n=>n.user.displayName.toLowerCase().includes(i.toLowerCase()));return e.jsxs(L,{isOpen:t,onClose:o,title:`Members (${a?.memberCount||0})`,width:"800px",children:[e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsx("input",{type:"text",placeholder:"Search members...",value:i,onChange:n=>m(n.target.value),style:{width:"100%",padding:"10px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white"}})}),e.jsxs("div",{style:{height:"60vh",overflowY:"auto"},children:[p&&r.length===0?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"Loading members..."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"10px"},children:g.map(n=>e.jsxs(C,{style:{padding:"10px",display:"flex",alignItems:"center",gap:"10px",cursor:"pointer"},onClick:()=>c(n.userId),children:[e.jsx("img",{src:n.user.userIcon||n.user.currentAvatarThumbnailImageUrl,alt:n.user.displayName,style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover"}}),e.jsxs("div",{style:{overflow:"hidden"},children:[e.jsx("div",{style:{fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n.user.displayName}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#aaa"},children:n.membershipStatus})]})]},n.id))}),!p&&g.length===0&&e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"No members found."})]})]})},re=({isOpen:t,onClose:o})=>{const{requests:r,selectedGroup:a,fetchGroupRequests:l,isRequestsLoading:p}=_(),{openProfile:c}=P();return u.useEffect(()=>{t&&a&&l(a.id)},[t,a,l]),e.jsx(L,{isOpen:t,onClose:o,title:`Join Requests (${r.length})`,width:"600px",children:e.jsx("div",{style:{height:"60vh",overflowY:"auto",display:"flex",flexDirection:"column",gap:"10px"},children:p?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"Loading requests..."}):r.length>0?r.map(i=>e.jsxs(C,{style:{padding:"15px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",cursor:"pointer"},onClick:()=>c(i.user.id),children:[e.jsx("img",{src:i.user.userIcon||i.user.currentAvatarThumbnailImageUrl,alt:i.user.displayName,style:{width:"50px",height:"50px",borderRadius:"50%",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[i.user.displayName,(i.user.ageVerified||i.user.tags?.includes("system_age_verified"))&&e.jsx("span",{style:{background:"#fbbf24",color:"black",fontSize:"0.6rem",padding:"1px 4px",borderRadius:"4px",fontWeight:"800"},children:"18+"})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#aaa"},children:["Requested: ",new Date(i.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx(S,{variant:"ghost",style:{color:"#ef4444"},children:"Deny"}),e.jsx(S,{variant:"primary",children:"Accept"})]})]},i.id)):e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"No pending requests."})})})},ie=({isOpen:t,onClose:o})=>{const{bans:r,selectedGroup:a,fetchGroupBans:l,isBansLoading:p}=_(),{openProfile:c}=P(),[i,m]=u.useState("");u.useEffect(()=>{t&&a&&l(a.id)},[t,a,l]);const g=r.filter(n=>n.user.displayName.toLowerCase().includes(i.toLowerCase()));return e.jsxs(L,{isOpen:t,onClose:o,title:`Active Bans (${r.length})`,width:"700px",children:[e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsx("input",{type:"text",placeholder:"Search banned users...",value:i,onChange:n=>m(n.target.value),style:{width:"100%",padding:"10px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white"}})}),e.jsx("div",{style:{height:"60vh",overflowY:"auto",display:"flex",flexDirection:"column",gap:"10px"},children:p?e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"Loading bans..."}):g.length>0?g.map(n=>e.jsxs(C,{style:{padding:"15px",display:"flex",alignItems:"center",justifyContent:"space-between",borderLeft:"3px solid #ef4444"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",cursor:"pointer"},onClick:()=>c(n.user.id),children:[e.jsx("img",{src:n.user.userIcon||n.user.currentAvatarThumbnailImageUrl,alt:n.user.displayName,style:{width:"50px",height:"50px",borderRadius:"50%",objectFit:"cover",filter:"grayscale(100%)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",color:"#ef4444"},children:n.user.displayName}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#aaa"},children:["Banned: ",new Date(n.createdAt).toLocaleDateString()]})]})]}),e.jsx(S,{variant:"ghost",children:"Unban"})]},n.id)):e.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#888"},children:"No active bans found."})})]})},ne=({isOpen:t,onClose:o})=>{const{instances:r,isInstancesLoading:a,selectedGroup:l,fetchGroupInstances:p}=_(),[c,i]=u.useState(null);u.useEffect(()=>{t&&l&&p(l.id)},[t,l,p]);const m=()=>{l&&p(l.id)},g=s=>{const f=s.location||s.id||"";console.log("Joining instance:",f)},n=s=>{i(s)},y=()=>{if(c){const s=c.location||c.id||"";console.log("Closing instance:",s),i(null)}},d=s=>{if(!s)return"US";const f=s.match(/~region\(([^)]+)\)/);return f?f[1].toUpperCase():"US"},b=s=>s.n_users||s.userCount||s.memberCount||0,j=s=>s.capacity||s.world?.capacity||40;return e.jsxs(e.Fragment,{children:[e.jsx(L,{isOpen:t,onClose:o,title:`Active Instances (${r.length})`,width:"600px",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(S,{size:"sm",onClick:m,disabled:a,children:a?"Loading...":"Refresh"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",maxHeight:"50vh",overflowY:"auto",paddingRight:"4px"},children:a&&r.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"var(--color-text-dim)"},children:"Loading instances..."}):r.length>0?r.map((s,f)=>e.jsxs(C,{style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("div",{style:{width:"120px",height:"80px",borderRadius:"var(--border-radius)",background:"#1a1a2e",backgroundImage:s.world?.thumbnailImageUrl?`url(${s.world.thumbnailImageUrl})`:s.world?.imageUrl?`url(${s.world.imageUrl})`:"none",backgroundSize:"cover",backgroundPosition:"center",flexShrink:0,border:"1px solid var(--border-color)"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h4",{style:{margin:"0 0 0.25rem 0",fontSize:"1rem",fontWeight:600,color:"var(--color-text-main)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.world?.name||s.displayName||"Unknown World"}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--color-text-dim)",marginBottom:"0.5rem"},children:["by ",s.world?.authorName||"Unknown"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",fontSize:"0.75rem",color:"var(--color-text-dim)"},children:[e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:"rgba(255,255,255,0.05)",padding:"2px 8px",borderRadius:"4px"},children:["ðŸ‘¥ ",b(s)," / ",j(s)]}),e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:"rgba(255,255,255,0.05)",padding:"2px 8px",borderRadius:"4px"},children:["ðŸŒ ",d(s.location)]}),e.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:"rgba(100, 150, 255, 0.15)",padding:"2px 8px",borderRadius:"4px",color:"#8ab4ff",textTransform:"capitalize"},children:s.groupAccessType||s.type||"Public"}),s.ageGate&&e.jsx("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",background:"rgba(255, 180, 50, 0.2)",padding:"2px 8px",borderRadius:"4px",color:"#ffc045",fontWeight:600},children:"ðŸ”ž 18+"})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid var(--border-color)"},children:[e.jsx(S,{size:"sm",onClick:()=>g(s),style:{flex:1},children:"Join Instance"}),e.jsx(S,{size:"sm",variant:"secondary",onClick:()=>n(s),style:{flex:1},children:"Close Instance"})]})]},s.id||s.location||f)):e.jsxs("div",{style:{padding:"3rem",textAlign:"center",color:"var(--color-text-dim)",background:"rgba(255,255,255,0.02)",borderRadius:"var(--border-radius)",border:"1px dashed var(--border-color)"},children:[e.jsx("div",{style:{fontSize:"1rem",marginBottom:"0.5rem"},children:"No Active Instances"}),e.jsx("div",{style:{fontSize:"0.85rem",opacity:.7},children:"There are no active group instances at this time."})]})})]})}),e.jsx(L,{isOpen:!!c,onClose:()=>i(null),title:"Close Instance",width:"400px",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{color:"var(--color-text-main)",marginBottom:"0.5rem",fontSize:"1rem"},children:"Are you sure you want to close this instance?"}),e.jsx("p",{style:{color:"var(--color-primary)",fontWeight:600,marginBottom:"0.5rem"},children:c?.world?.name||"Unknown World"}),e.jsxs("p",{style:{color:"var(--color-text-dim)",fontSize:"0.85rem",marginBottom:"1.5rem"},children:["This will disconnect all ",b(c||{})," users."]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[e.jsx(S,{variant:"secondary",onClick:()=>i(null),children:"Cancel"}),e.jsx(S,{variant:"danger",onClick:y,children:"Close Instance"})]})]})})]})},oe=()=>e.jsxs("div",{title:"Synced with your local VRChat logs.",style:{display:"inline-flex",alignItems:"center",gap:"6px",background:"rgba(34, 197, 94, 0.1)",padding:"4px 8px",borderRadius:"12px",border:"1px solid rgba(34, 197, 94, 0.2)",cursor:"help",transition:"all 0.2s"},onMouseEnter:t=>{t.currentTarget.style.background="rgba(34, 197, 94, 0.2)",t.currentTarget.style.borderColor="rgba(34, 197, 94, 0.4)"},onMouseLeave:t=>{t.currentTarget.style.background="rgba(34, 197, 94, 0.1)",t.currentTarget.style.borderColor="rgba(34, 197, 94, 0.2)"},children:[e.jsxs("div",{style:{position:"relative",width:"6px",height:"6px"},children:[e.jsx("div",{style:{width:"6px",height:"6px",backgroundColor:"#22c55e",borderRadius:"50%",position:"absolute",top:0,left:0}}),e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#22c55e",borderRadius:"50%",zIndex:-1,animation:"pulse 2s infinite ease-in-out"}}),e.jsx("style",{children:`
           @keyframes pulse {
             0% { transform: scale(1); opacity: 1; }
             50% { transform: scale(3); opacity: 0; }
             100% { transform: scale(1); opacity: 0; }
           }
         `})]}),e.jsx("span",{style:{fontSize:"0.65rem",fontWeight:700,color:"#22c55e",letterSpacing:"0.5px"},children:"LIVE"})]}),ae=()=>{const{currentWorldName:t,currentWorldId:o,currentLocation:r,players:a}=Z(),{instances:l,myGroups:p,selectedGroup:c}=_(),i=r?l.find(d=>!!(d.location===r||d.worldId&&d.instanceId&&`${d.worldId}:${d.instanceId}`===r)):null,m=i&&c&&i.ownerId===c.id;if(!o&&!t)return e.jsx(C,{style:{height:"100%",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:e.jsxs("div",{style:{textAlign:"center",color:"var(--color-text-dim)"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--color-text-secondary)",fontSize:"1.1rem",marginBottom:"0.5rem"},children:"Waiting for VRChat..."}),e.jsx("div",{style:{fontSize:"0.9rem"},children:"Join a world to see live data"})]})});if(!i)return e.jsx(C,{style:{height:"100%",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:e.jsxs("div",{style:{textAlign:"center",color:"var(--color-text-dim)",maxWidth:"80%"},children:[e.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"var(--color-text-dim)",margin:"0 auto 1rem auto",boxShadow:"0 0 10px rgba(255,255,255,0.1)"}}),e.jsx("div",{style:{fontWeight:600,color:"var(--color-text-secondary)",fontSize:"1rem",marginBottom:"0.5rem"},children:"Roaming Mode"}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.7},children:["You are in ",e.jsx("strong",{children:t})]}),e.jsxs("div",{style:{fontSize:"0.75rem",marginTop:"1rem",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"0.5rem"},children:["Join a ",e.jsx("strong",{children:c?.name||"Group"})," instance to activate Command Center"]})]})});const g=i?.world?.name||t||"Unknown World",n=Object.keys(a).length,y=Object.values(a).sort((d,b)=>b.joinTime-d.joinTime);return e.jsxs(C,{style:{height:"100%",padding:"1rem",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"8px",marginBottom:"8px",flex:"0 0 auto"},children:[e.jsx("span",{style:{fontSize:"0.65rem",color:"var(--color-accent)",letterSpacing:"0.5px",fontWeight:600},children:"CURRENT INSTANCE"}),e.jsx(oe,{}),e.jsxs("span",{style:{fontSize:"0.6rem",background:m?"rgba(0, 255, 100, 0.1)":"rgba(255,255,255,0.1)",border:m?"1px solid var(--color-success)":"1px solid var(--color-primary)",color:m?"var(--color-success)":"var(--color-primary)",padding:"2px 8px",borderRadius:"12px",fontWeight:700,textTransform:"uppercase",letterSpacing:"0.5px",boxShadow:m?"0 0 10px rgba(0,255,100, 0.2)":"none",whiteSpace:"nowrap",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"},children:[i.group?.name||p.find(d=>d.id===i.ownerId)?.name||"GROUP"," INSTANCE"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem",marginBottom:"1rem",flex:"0 0 auto"},children:[e.jsxs("div",{style:{flex:"1 1 auto",minWidth:0,display:"flex",flexDirection:"column",gap:"2px"},children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"white",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:1.2},title:g,children:g}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255,255,255,0.4)",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:o})]}),e.jsxs("div",{style:{textAlign:"right",flex:"0 0 auto",marginTop:"-4px"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"var(--color-primary)",lineHeight:1},children:n}),e.jsx("div",{style:{fontSize:"0.65rem",color:"var(--color-text-dim)",fontWeight:600},children:"PLAYERS"})]})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",background:"rgba(0,0,0,0.2)",borderRadius:"8px",padding:"0.5rem",display:"flex",flexDirection:"column",gap:"2px",minHeight:0},children:[y.map(d=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",borderRadius:"4px",background:"rgba(255,255,255,0.03)",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontWeight:500},children:d.displayName}),e.jsx("span",{style:{fontSize:"0.75rem",color:"rgba(255,255,255,0.4)"},children:new Date(d.joinTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]},d.displayName)),y.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"1rem",fontSize:"0.8rem",color:"rgba(255,255,255,0.3)",marginTop:"auto",marginBottom:"auto"},children:"No players detected"})]})]})},le="_tile_1dy6z_3",ce="_header_1dy6z_57",de="_labelContainer_1dy6z_73",ue="_label_1dy6z_73",pe="_value_1dy6z_97",k={tile:le,header:ce,labelContainer:de,label:ue,value:pe},D=({label:t,value:o,loading:r=!1,color:a="var(--color-text-dim)",onClick:l,headerRight:p,headerLeftExtra:c})=>{const i=m=>{l&&(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),l())};return e.jsxs("div",{role:"button",tabIndex:0,className:k.tile,onClick:l,onKeyDown:i,children:[e.jsxs("div",{className:k.header,children:[e.jsxs("div",{className:k.labelContainer,children:[e.jsx("small",{className:k.label,style:{color:a},children:t}),c]}),p]}),e.jsx("div",{className:k.value,children:r?"...":o})]})},he="_container_spmgi_1",ge="_headerPanel_spmgi_15",xe="_titleSection_spmgi_35",me="_title_spmgi_35",fe="_subtitle_spmgi_57",ye="_statsGrid_spmgi_71",ve="_contentGrid_spmgi_87",be="_auditPanel_spmgi_119",je="_auditHeader_spmgi_133",we="_auditTitle_spmgi_153",Se="_liveIndicator_spmgi_177",Ce="_logList_spmgi_193",Re="_emptyState_spmgi_207",_e="_logItem_spmgi_223",Ie="_logDot_spmgi_251",Ne="_logContent_spmgi_265",ke="_logMeta_spmgi_275",Le="_actorName_spmgi_289",Te="_timestamp_spmgi_301",Me="_logDescription_spmgi_313",De="_monitorColumn_spmgi_323",x={container:he,headerPanel:ge,titleSection:xe,title:me,subtitle:fe,statsGrid:ye,contentGrid:ve,auditPanel:be,auditHeader:je,auditTitle:we,liveIndicator:Se,logList:Ce,emptyState:Re,logItem:_e,logDot:Ie,logContent:Ne,logMeta:ke,actorName:Le,timestamp:Te,logDescription:Me,monitorColumn:De},ze={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},z={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}}},Ee=["group.user.join","group.user.leave","group.user.ban","group.user.unban","group.user.kick","group.invite.accept"],Ae=u.memo(()=>{const{selectedGroup:t,requests:o,bans:r,instances:a,isRequestsLoading:l,isBansLoading:p,isInstancesLoading:c,fetchGroupMembers:i,isMembersLoading:m}=_(),{logs:g,fetchLogs:n,isLoading:y}=ee(),d=J(),b=U({type:"instances"}),j=U({type:"requests"}),s=U({type:"bans"}),[f,I]=u.useState(!1),[E,w]=u.useState(!1),[A,v]=u.useState(!1),[N,F]=u.useState(!1),[T,$]=u.useState(0),G=B.useRef(0),W=B.useRef(!1),q=B.useRef(null);u.useEffect(()=>{t&&(q.current!==t.id&&(W.current=!1,G.current=0,q.current=t.id),W.current||(i(t.id,0),W.current=!0))},[t,i]),u.useEffect(()=>{if(!t||g.length===0)return;const h=G.current;g.length>h&&h>0&&g.slice(0,g.length-h).some(V=>Ee.some(O=>V.eventType?.includes(O)||V.type?.includes(O)))&&i(t.id,0),G.current=g.length},[g,t,i]),u.useEffect(()=>{if(T>0){const h=setTimeout(()=>{$(H=>H-1)},1e3);return()=>clearTimeout(h)}},[T]);const K=h=>{h?.stopPropagation(),!(T>0||!t)&&(i(t.id,0),$(30))};return u.useEffect(()=>{t&&n(t.id)},[t,n]),e.jsx(e.Fragment,{children:e.jsxs(R.div,{className:x.container,variants:ze,initial:"hidden",animate:"show",children:[e.jsxs(C,{className:x.headerPanel,children:[e.jsxs("div",{className:x.titleSection,children:[e.jsx(R.h1,{className:`${x.title} text-gradient`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:t?.name||"Dashboard"}),e.jsx(R.div,{className:x.subtitle,initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:"COMMAND CENTER"})]}),e.jsxs("div",{className:x.statsGrid,children:[e.jsx(R.div,{variants:z,style:{height:"100%"},children:e.jsx(D,{label:"MEMBERS",value:t?.memberCount||0,color:"var(--color-primary)",onClick:()=>I(!0),headerLeftExtra:d.connected&&e.jsx(te,{}),headerRight:e.jsx(M,{secondsUntilRefresh:T,isRefreshing:m,onRefreshClick:K})})}),e.jsx(R.div,{variants:z,style:{height:"100%"},children:e.jsx(D,{label:"INSTANCES",value:c?"...":a.length,color:"var(--color-info)",onClick:()=>F(!0),headerRight:e.jsx(M,{secondsUntilRefresh:b.secondsUntilRefresh,isRefreshing:b.isRefreshing,onRefreshClick:h=>{h?.stopPropagation(),b.refreshNow()}})})}),e.jsx(R.div,{variants:z,style:{height:"100%"},children:e.jsx(D,{label:"REQUESTS",value:l?"...":o.length,color:"var(--color-accent)",onClick:()=>w(!0),headerRight:e.jsx(M,{secondsUntilRefresh:j.secondsUntilRefresh,isRefreshing:j.isRefreshing,onRefreshClick:h=>{h?.stopPropagation(),j.refreshNow()}})})}),e.jsx(R.div,{variants:z,style:{height:"100%"},children:e.jsx(D,{label:"BANS",value:p?"...":r.length,color:"var(--color-danger)",onClick:()=>v(!0),headerRight:e.jsx(M,{secondsUntilRefresh:s.secondsUntilRefresh,isRefreshing:s.isRefreshing,onRefreshClick:h=>{h?.stopPropagation(),s.refreshNow()}})})})]})]}),e.jsxs("div",{className:x.contentGrid,children:[e.jsxs(C,{className:x.auditPanel,children:[e.jsxs("div",{className:x.auditHeader,children:[e.jsxs("div",{className:x.auditTitle,children:[e.jsx("h3",{children:"Live Audit Feed"}),e.jsx("div",{className:x.liveIndicator})]}),e.jsx(S,{size:"sm",variant:"ghost",onClick:()=>t&&n(t.id),disabled:y,children:y?"SYNCING...":"REFRESH"})]}),e.jsx("div",{className:x.logList,children:g.length===0&&!y?e.jsx("div",{className:x.emptyState,children:"-- No visible spectrum events --"}):g.map(h=>e.jsxs("div",{className:x.logItem,children:[e.jsx("div",{className:x.logDot,style:{background:h.eventType?.includes("ban")?"var(--color-danger)":h.eventType?.includes("join")?"var(--color-success)":"var(--color-accent)",boxShadow:h.eventType?.includes("ban")?"0 0 8px rgba(239, 68, 68, 0.4)":"none"}}),e.jsxs("div",{className:x.logContent,children:[e.jsxs("div",{className:x.logMeta,children:[e.jsx("span",{className:x.actorName,children:h.actorDisplayName}),e.jsx("span",{className:x.timestamp,children:new Date(h.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]}),e.jsx("div",{className:x.logDescription,children:h.description||h.eventType})]})]},h.id))})]}),e.jsx("div",{className:x.monitorColumn,children:e.jsx(ae,{})})]}),e.jsx(se,{isOpen:f,onClose:()=>I(!1)}),e.jsx(re,{isOpen:E,onClose:()=>w(!1)}),e.jsx(ie,{isOpen:A,onClose:()=>v(!1)}),e.jsx(ne,{isOpen:N,onClose:()=>F(!1)})]})})});Ae.displayName="DashboardView";export{Ae as DashboardView};
